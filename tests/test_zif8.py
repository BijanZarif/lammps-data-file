from lammps_data.crystal import MOF
from lammps_data.bonds import extrapolate_bonds
from lammps_data.angles import get_angles
from lammps_data.dihedrals import get_dihedrals

expected_angles = [(0, 23, 21), (0, 44, 37), (0, 44, 38), (1, 20, 18), (1, 47, 37), (1, 47, 45), (2, 5, 3), (2, 31, 24), (2, 31, 25), (3, 21, 22), (3, 21, 23), (4, 3, 5), (4, 3, 21), (5, 2, 31), (5, 3, 21), (6, 8, 9), (6, 18, 19), (6, 18, 20), (7, 6, 8), (7, 6, 18), (8, 6, 18), (8, 9, 36), (9, 36, 32), (9, 36, 33), (10, 12, 13), (10, 15, 16), (10, 15, 17), (11, 10, 12), (11, 10, 15), (12, 10, 15), (12, 13, 53), (13, 53, 32), (13, 53, 48), (14, 17, 15), (14, 56, 24), (14, 56, 54), (16, 15, 17), (17, 14, 56), (19, 18, 20), (20, 1, 47), (22, 21, 23), (23, 0, 44), (24, 27, 28), (24, 27, 29), (24, 27, 30), (24, 31, 25), (24, 56, 54), (25, 54, 55), (25, 54, 56), (26, 25, 31), (26, 25, 54), (27, 24, 31), (27, 24, 56), (28, 27, 29), (28, 27, 30), (29, 27, 30), (31, 24, 56), (31, 25, 54), (32, 35, 50), (32, 35, 51), (32, 35, 52), (32, 36, 33), (32, 53, 48), (33, 48, 49), (33, 48, 53), (34, 33, 36), (34, 33, 48), (35, 32, 36), (35, 32, 53), (36, 32, 53), (36, 33, 48), (37, 40, 41), (37, 40, 42), (37, 40, 43), (37, 44, 38), (37, 47, 45), (38, 45, 46), (38, 45, 47), (39, 38, 44), (39, 38, 45), (40, 37, 44), (40, 37, 47), (41, 40, 42), (41, 40, 43), (42, 40, 43), (44, 37, 47), (44, 38, 45), (46, 45, 47), (49, 48, 53), (50, 35, 51), (50, 35, 52), (51, 35, 52), (55, 54, 56), (57, 65, 63), (57, 81, 71), (57, 81, 76), (58, 62, 60), (58, 70, 66), (58, 70, 67), (59, 87, 66), (59, 87, 82), (59, 90, 88), (60, 63, 64), (60, 63, 65), (61, 60, 62), (61, 60, 63), (62, 58, 70), (62, 60, 63), (64, 63, 65), (65, 57, 81), (66, 69, 84), (66, 69, 85), (66, 69, 86), (66, 70, 67), (66, 87, 82), (67, 82, 83), (67, 82, 87), (68, 67, 70), (68, 67, 82), (69, 66, 70), (69, 66, 87), (70, 66, 87), (70, 67, 82), (71, 74, 78), (71, 74, 79), (71, 74, 80), (71, 75, 72), (71, 75, 94), (71, 81, 76), (72, 75, 94), (72, 76, 77), (72, 76, 81), (73, 72, 75), (73, 72, 76), (74, 71, 75), (74, 71, 81), (75, 71, 81), (75, 72, 76), (75, 94, 101), (77, 76, 81), (78, 74, 79), (78, 74, 80), (79, 74, 80), (83, 82, 87), (84, 69, 85), (84, 69, 86), (85, 69, 86), (87, 59, 90), (88, 91, 92), (88, 91, 93), (89, 88, 90), (89, 88, 91), (90, 88, 91), (91, 93, 95), (92, 91, 93), (93, 95, 113), (94, 101, 99), (95, 113, 103), (95, 113, 111), (96, 98, 102), (96, 99, 100), (96, 99, 101), (97, 96, 98), (97, 96, 99), (98, 96, 99), (98, 102, 110), (100, 99, 101), (102, 110, 103), (102, 110, 104), (103, 106, 107), (103, 106, 108), (103, 106, 109), (103, 110, 104), (103, 113, 111), (104, 111, 112), (104, 111, 113), (105, 104, 110), (105, 104, 111), (106, 103, 110), (106, 103, 113), (107, 106, 108), (107, 106, 109), (108, 106, 109), (110, 103, 113), (110, 104, 111), (112, 111, 113), (114, 115, 116), (114, 115, 117), (114, 115, 118), (116, 115, 117), (116, 115, 118), (117, 115, 118), (119, 120, 121), (119, 120, 122), (119, 120, 123), (121, 120, 122), (121, 120, 123), (122, 120, 123), (124, 125, 126), (124, 125, 127), (124, 125, 128), (126, 125, 127), (126, 125, 128), (127, 125, 128), (129, 130, 131), (129, 130, 132), (129, 130, 133), (131, 130, 132), (131, 130, 133), (132, 130, 133), (134, 135, 136), (134, 135, 137), (134, 135, 138), (136, 135, 137), (136, 135, 138), (137, 135, 138), (139, 140, 141), (139, 140, 142), (139, 140, 143), (141, 140, 142), (141, 140, 143), (142, 140, 143), (144, 149, 147), (144, 157, 153), (144, 157, 154), (145, 152, 150), (145, 162, 158), (145, 162, 159), (146, 174, 153), (146, 174, 169), (146, 180, 178), (147, 150, 151), (147, 150, 152), (148, 147, 149), (148, 147, 150), (149, 144, 157), (149, 147, 150), (151, 150, 152), (152, 145, 162), (153, 156, 171), (153, 156, 172), (153, 156, 173), (153, 157, 154), (153, 174, 169), (154, 169, 170), (154, 169, 174), (155, 154, 157), (155, 154, 169), (156, 153, 157), (156, 153, 174), (157, 153, 174), (157, 154, 169), (158, 161, 165), (158, 161, 166), (158, 161, 167), (158, 162, 159), (158, 168, 163), (158, 168, 181), (159, 163, 164), (159, 163, 168), (160, 159, 162), (160, 159, 163), (161, 158, 162), (161, 158, 168), (162, 158, 168), (162, 159, 163), (163, 168, 181), (164, 163, 168), (165, 161, 166), (165, 161, 167), (166, 161, 167), (168, 181, 188), (170, 169, 174), (171, 156, 172), (171, 156, 173), (172, 156, 173), (174, 146, 180), (175, 177, 182), (175, 178, 179), (175, 178, 180), (176, 175, 177), (176, 175, 178), (177, 175, 178), (177, 182, 200), (179, 178, 180), (181, 188, 186), (182, 200, 190), (182, 200, 198), (183, 185, 189), (183, 186, 187), (183, 186, 188), (184, 183, 185), (184, 183, 186), (185, 183, 186), (185, 189, 197), (187, 186, 188), (189, 197, 190), (189, 197, 191), (190, 193, 194), (190, 193, 195), (190, 193, 196), (190, 197, 191), (190, 200, 198), (191, 198, 199), (191, 198, 200), (192, 191, 197), (192, 191, 198), (193, 190, 197), (193, 190, 200), (194, 193, 195), (194, 193, 196), (195, 193, 196), (197, 190, 200), (197, 191, 198), (199, 198, 200), (201, 230, 228), (201, 251, 231), (201, 251, 249), (202, 227, 225), (202, 248, 239), (202, 248, 243), (203, 206, 204), (203, 211, 239), (203, 211, 240), (204, 207, 208), (204, 207, 209), (205, 204, 206), (205, 204, 207), (206, 203, 211), (206, 204, 207), (207, 209, 210), (208, 207, 209), (209, 210, 222), (210, 222, 212), (210, 222, 220), (211, 239, 242), (211, 239, 248), (211, 240, 241), (211, 240, 243), (212, 215, 216), (212, 215, 217), (212, 215, 218), (212, 219, 213), (212, 219, 223), (212, 222, 220), (213, 219, 223), (213, 220, 221), (213, 220, 222), (214, 213, 219), (214, 213, 220), (215, 212, 219), (215, 212, 222), (216, 215, 217), (216, 215, 218), (217, 215, 218), (219, 212, 222), (219, 213, 220), (219, 223, 257), (221, 220, 222), (223, 257, 255), (224, 238, 231), (224, 238, 232), (224, 254, 252), (225, 228, 229), (225, 228, 230), (226, 225, 227), (226, 225, 228), (227, 202, 248), (227, 225, 228), (229, 228, 230), (230, 201, 251), (231, 234, 235), (231, 234, 236), (231, 234, 237), (231, 238, 232), (231, 251, 249), (232, 249, 250), (232, 249, 251), (233, 232, 238), (233, 232, 249), (234, 231, 238), (234, 231, 251), (235, 234, 236), (235, 234, 237), (236, 234, 237), (238, 224, 254), (238, 231, 251), (238, 232, 249), (239, 211, 240), (239, 242, 245), (239, 242, 246), (239, 242, 247), (239, 248, 243), (240, 243, 244), (240, 243, 248), (241, 240, 243), (242, 239, 248), (244, 243, 248), (245, 242, 246), (245, 242, 247), (246, 242, 247), (250, 249, 251), (252, 255, 256), (252, 255, 257), (253, 252, 254), (253, 252, 255), (254, 252, 255), (256, 255, 257), (258, 259, 260), (258, 259, 261), (258, 259, 262), (260, 259, 261), (260, 259, 262), (261, 259, 262), (263, 264, 265), (263, 264, 266), (263, 264, 267), (265, 264, 266), (265, 264, 267), (266, 264, 267), (268, 269, 270), (268, 269, 271), (268, 269, 272), (270, 269, 271), (270, 269, 272), (271, 269, 272), (273, 274, 275), (273, 274, 276), (273, 274, 277), (275, 274, 276), (275, 274, 277), (276, 274, 277), (278, 279, 280), (278, 279, 281), (278, 279, 282), (280, 279, 281), (280, 279, 282), (281, 279, 282), (283, 284, 285), (283, 284, 286), (283, 284, 287), (285, 284, 286), (285, 284, 287), (286, 284, 287)]
expected_dihedrals = [(0, 21, 23, 3), (0, 21, 23, 22), (0, 37, 44, 40), (0, 37, 44, 47), (0, 38, 44, 39), (0, 38, 44, 45), (1, 18, 20, 6), (1, 18, 20, 19), (1, 37, 47, 40), (1, 37, 47, 44), (1, 45, 47, 38), (1, 45, 47, 46), (2, 3, 5, 4), (2, 3, 5, 21), (2, 24, 31, 27), (2, 24, 31, 56), (2, 25, 31, 26), (2, 25, 31, 54), (3, 2, 5, 31), (4, 3, 21, 22), (4, 3, 21, 23), (5, 2, 31, 24), (5, 2, 31, 25), (5, 3, 21, 22), (5, 3, 21, 23), (6, 8, 9, 36), (7, 6, 8, 9), (7, 6, 18, 19), (7, 6, 18, 20), (8, 6, 18, 19), (8, 6, 18, 20), (8, 9, 36, 32), (8, 9, 36, 33), (9, 6, 8, 18), (9, 32, 36, 35), (9, 32, 36, 53), (9, 33, 36, 34), (9, 33, 36, 48), (10, 12, 13, 53), (10, 15, 17, 14), (11, 10, 12, 13), (11, 10, 15, 16), (11, 10, 15, 17), (12, 10, 15, 16), (12, 10, 15, 17), (12, 13, 53, 32), (12, 13, 53, 48), (13, 10, 12, 15), (13, 32, 53, 35), (13, 32, 53, 36), (13, 48, 53, 33), (13, 48, 53, 49), (14, 15, 17, 16), (14, 24, 56, 27), (14, 24, 56, 31), (14, 54, 56, 25), (14, 54, 56, 55), (15, 14, 17, 56), (17, 14, 56, 24), (17, 14, 56, 54), (18, 1, 20, 47), (20, 1, 47, 37), (20, 1, 47, 45), (21, 0, 23, 44), (23, 0, 44, 37), (23, 0, 44, 38), (24, 25, 31, 26), (24, 25, 31, 54), (24, 54, 56, 25), (24, 54, 56, 55), (25, 24, 31, 27), (25, 24, 31, 56), (26, 25, 54, 55), (26, 25, 54, 56), (27, 24, 56, 54), (28, 24, 27, 31), (28, 24, 27, 56), (29, 24, 27, 31), (29, 24, 27, 56), (30, 24, 27, 31), (30, 24, 27, 56), (31, 24, 56, 54), (31, 25, 54, 55), (31, 25, 54, 56), (32, 33, 36, 34), (32, 33, 36, 48), (32, 48, 53, 33), (32, 48, 53, 49), (33, 32, 36, 35), (33, 32, 36, 53), (34, 33, 48, 49), (34, 33, 48, 53), (35, 32, 53, 48), (36, 32, 35, 50), (36, 32, 35, 51), (36, 32, 35, 52), (36, 32, 53, 48), (36, 33, 48, 49), (36, 33, 48, 53), (37, 38, 44, 39), (37, 38, 44, 45), (37, 45, 47, 38), (37, 45, 47, 46), (38, 37, 44, 40), (38, 37, 44, 47), (39, 38, 45, 46), (39, 38, 45, 47), (40, 37, 47, 45), (41, 37, 40, 44), (41, 37, 40, 47), (42, 37, 40, 44), (42, 37, 40, 47), (43, 37, 40, 44), (43, 37, 40, 47), (44, 37, 47, 45), (44, 38, 45, 46), (44, 38, 45, 47), (50, 32, 35, 53), (51, 32, 35, 53), (52, 32, 35, 53), (57, 63, 65, 60), (57, 63, 65, 64), (57, 71, 81, 74), (57, 71, 81, 75), (57, 76, 81, 72), (57, 76, 81, 77), (58, 60, 62, 61), (58, 60, 62, 63), (58, 66, 70, 69), (58, 66, 70, 87), (58, 67, 70, 68), (58, 67, 70, 82), (59, 66, 87, 69), (59, 66, 87, 70), (59, 82, 87, 67), (59, 82, 87, 83), (59, 88, 90, 89), (59, 88, 90, 91), (60, 58, 62, 70), (61, 60, 63, 64), (61, 60, 63, 65), (62, 58, 70, 66), (62, 58, 70, 67), (62, 60, 63, 64), (62, 60, 63, 65), (63, 57, 65, 81), (65, 57, 81, 71), (65, 57, 81, 76), (66, 59, 87, 90), (66, 67, 70, 68), (66, 67, 70, 82), (66, 82, 87, 67), (66, 82, 87, 83), (67, 66, 70, 69), (67, 66, 70, 87), (68, 67, 82, 83), (68, 67, 82, 87), (69, 66, 87, 82), (70, 66, 69, 84), (70, 66, 69, 85), (70, 66, 69, 86), (70, 66, 87, 82), (70, 67, 82, 83), (70, 67, 82, 87), (71, 72, 75, 73), (71, 72, 75, 76), (71, 75, 94, 101), (71, 76, 81, 72), (71, 76, 81, 77), (72, 71, 75, 74), (72, 71, 75, 81), (72, 75, 94, 101), (73, 72, 75, 94), (73, 72, 76, 77), (73, 72, 76, 81), (74, 71, 75, 94), (74, 71, 81, 76), (75, 71, 74, 78), (75, 71, 74, 79), (75, 71, 74, 80), (75, 71, 81, 76), (75, 72, 76, 77), (75, 72, 76, 81), (75, 94, 101, 99), (76, 72, 75, 94), (78, 71, 74, 81), (79, 71, 74, 81), (80, 71, 74, 81), (81, 71, 75, 94), (82, 59, 87, 90), (84, 66, 69, 87), (85, 66, 69, 87), (86, 66, 69, 87), (87, 59, 90, 88), (88, 91, 93, 95), (89, 88, 91, 92), (89, 88, 91, 93), (90, 88, 91, 92), (90, 88, 91, 93), (91, 93, 95, 113), (92, 91, 93, 95), (93, 95, 113, 103), (93, 95, 113, 111), (94, 99, 101, 96), (94, 99, 101, 100), (95, 103, 113, 106), (95, 103, 113, 110), (95, 111, 113, 104), (95, 111, 113, 112), (96, 98, 102, 110), (97, 96, 98, 102), (97, 96, 99, 100), (97, 96, 99, 101), (98, 96, 99, 100), (98, 96, 99, 101), (98, 102, 110, 103), (98, 102, 110, 104), (99, 96, 98, 102), (102, 103, 110, 106), (102, 103, 110, 113), (102, 104, 110, 105), (102, 104, 110, 111), (103, 104, 110, 105), (103, 104, 110, 111), (103, 111, 113, 104), (103, 111, 113, 112), (104, 103, 110, 106), (104, 103, 110, 113), (105, 104, 111, 112), (105, 104, 111, 113), (106, 103, 113, 111), (107, 103, 106, 110), (107, 103, 106, 113), (108, 103, 106, 110), (108, 103, 106, 113), (109, 103, 106, 110), (109, 103, 106, 113), (110, 103, 113, 111), (110, 104, 111, 112), (110, 104, 111, 113), (144, 147, 149, 148), (144, 147, 149, 150), (144, 153, 157, 156), (144, 153, 157, 174), (144, 154, 157, 155), (144, 154, 157, 169), (145, 150, 152, 147), (145, 150, 152, 151), (145, 158, 162, 161), (145, 158, 162, 168), (145, 159, 162, 160), (145, 159, 162, 163), (146, 153, 174, 156), (146, 153, 174, 157), (146, 169, 174, 154), (146, 169, 174, 170), (146, 178, 180, 175), (146, 178, 180, 179), (147, 144, 149, 157), (148, 147, 150, 151), (148, 147, 150, 152), (149, 144, 157, 153), (149, 144, 157, 154), (149, 147, 150, 151), (149, 147, 150, 152), (150, 145, 152, 162), (152, 145, 162, 158), (152, 145, 162, 159), (153, 146, 174, 180), (153, 154, 157, 155), (153, 154, 157, 169), (153, 169, 174, 154), (153, 169, 174, 170), (154, 153, 157, 156), (154, 153, 157, 174), (155, 154, 169, 170), (155, 154, 169, 174), (156, 153, 174, 169), (157, 153, 156, 171), (157, 153, 156, 172), (157, 153, 156, 173), (157, 153, 174, 169), (157, 154, 169, 170), (157, 154, 169, 174), (158, 159, 162, 160), (158, 159, 162, 163), (158, 163, 168, 159), (158, 163, 168, 164), (158, 168, 181, 188), (159, 158, 162, 161), (159, 158, 162, 168), (159, 163, 168, 181), (160, 159, 163, 164), (160, 159, 163, 168), (161, 158, 168, 163), (161, 158, 168, 181), (162, 158, 161, 165), (162, 158, 161, 166), (162, 158, 161, 167), (162, 158, 168, 163), (162, 158, 168, 181), (162, 159, 163, 164), (162, 159, 163, 168), (163, 168, 181, 188), (164, 163, 168, 181), (165, 158, 161, 168), (166, 158, 161, 168), (167, 158, 161, 168), (168, 181, 188, 186), (169, 146, 174, 180), (171, 153, 156, 174), (172, 153, 156, 174), (173, 153, 156, 174), (174, 146, 180, 178), (175, 177, 182, 200), (176, 175, 177, 182), (176, 175, 178, 179), (176, 175, 178, 180), (177, 175, 178, 179), (177, 175, 178, 180), (177, 182, 200, 190), (177, 182, 200, 198), (178, 175, 177, 182), (181, 186, 188, 183), (181, 186, 188, 187), (182, 190, 200, 193), (182, 190, 200, 197), (182, 198, 200, 191), (182, 198, 200, 199), (183, 185, 189, 197), (184, 183, 185, 189), (184, 183, 186, 187), (184, 183, 186, 188), (185, 183, 186, 187), (185, 183, 186, 188), (185, 189, 197, 190), (185, 189, 197, 191), (186, 183, 185, 189), (189, 190, 197, 193), (189, 190, 197, 200), (189, 191, 197, 192), (189, 191, 197, 198), (190, 191, 197, 192), (190, 191, 197, 198), (190, 198, 200, 191), (190, 198, 200, 199), (191, 190, 197, 193), (191, 190, 197, 200), (192, 191, 198, 199), (192, 191, 198, 200), (193, 190, 200, 198), (194, 190, 193, 197), (194, 190, 193, 200), (195, 190, 193, 197), (195, 190, 193, 200), (196, 190, 193, 197), (196, 190, 193, 200), (197, 190, 200, 198), (197, 191, 198, 199), (197, 191, 198, 200), (201, 228, 230, 225), (201, 228, 230, 229), (201, 231, 251, 234), (201, 231, 251, 238), (201, 249, 251, 232), (201, 249, 251, 250), (202, 225, 227, 226), (202, 225, 227, 228), (202, 239, 248, 211), (202, 239, 248, 242), (202, 243, 248, 240), (202, 243, 248, 244), (203, 204, 206, 205), (203, 204, 206, 207), (203, 211, 239, 242), (203, 211, 239, 248), (203, 211, 240, 241), (203, 211, 240, 243), (204, 203, 206, 211), (204, 207, 209, 210), (205, 204, 207, 208), (205, 204, 207, 209), (206, 203, 211, 239), (206, 203, 211, 240), (206, 204, 207, 208), (206, 204, 207, 209), (207, 209, 210, 222), (208, 207, 209, 210), (209, 210, 222, 212), (209, 210, 222, 220), (210, 212, 222, 215), (210, 212, 222, 219), (210, 220, 222, 213), (210, 220, 222, 221), (211, 239, 242, 245), (211, 239, 242, 246), (211, 239, 242, 247), (211, 239, 248, 243), (211, 240, 243, 244), (211, 240, 243, 248), (212, 213, 219, 214), (212, 213, 219, 220), (212, 219, 223, 257), (212, 220, 222, 213), (212, 220, 222, 221), (213, 212, 219, 215), (213, 212, 219, 222), (213, 219, 223, 257), (214, 213, 219, 223), (214, 213, 220, 221), (214, 213, 220, 222), (215, 212, 219, 223), (215, 212, 222, 220), (216, 212, 215, 219), (216, 212, 215, 222), (217, 212, 215, 219), (217, 212, 215, 222), (218, 212, 215, 219), (218, 212, 215, 222), (219, 212, 222, 220), (219, 213, 220, 221), (219, 213, 220, 222), (219, 223, 257, 255), (220, 213, 219, 223), (222, 212, 219, 223), (223, 255, 257, 252), (223, 255, 257, 256), (224, 231, 238, 234), (224, 231, 238, 251), (224, 232, 238, 233), (224, 232, 238, 249), (224, 252, 254, 253), (224, 252, 254, 255), (225, 202, 227, 248), (226, 225, 228, 229), (226, 225, 228, 230), (227, 202, 248, 239), (227, 202, 248, 243), (227, 225, 228, 229), (227, 225, 228, 230), (228, 201, 230, 251), (230, 201, 251, 231), (230, 201, 251, 249), (231, 224, 238, 254), (231, 232, 238, 233), (231, 232, 238, 249), (231, 249, 251, 232), (231, 249, 251, 250), (232, 224, 238, 254), (232, 231, 238, 234), (232, 231, 238, 251), (233, 232, 249, 250), (233, 232, 249, 251), (234, 231, 251, 249), (235, 231, 234, 238), (235, 231, 234, 251), (236, 231, 234, 238), (236, 231, 234, 251), (237, 231, 234, 238), (237, 231, 234, 251), (238, 224, 254, 252), (238, 231, 251, 249), (238, 232, 249, 250), (238, 232, 249, 251), (239, 211, 240, 241), (239, 211, 240, 243), (239, 243, 248, 240), (239, 243, 248, 244), (240, 211, 239, 242), (240, 211, 239, 248), (241, 240, 243, 244), (241, 240, 243, 248), (242, 239, 248, 243), (245, 239, 242, 248), (246, 239, 242, 248), (247, 239, 242, 248), (253, 252, 255, 256), (253, 252, 255, 257), (254, 252, 255, 256), (254, 252, 255, 257)]


def test_zif8():
    zif8 = MOF('tests/ZIF-8.xyz')

    zif8.bonds = extrapolate_bonds(zif8.atoms)
    assert len(zif8.bonds) == 288

    zif8.angles = get_angles(zif8.bonds)
    assert len(zif8.angles) == 444
    assert zif8.angles == expected_angles

    zif8.dihedrals = get_dihedrals(zif8.bonds)
    assert len(zif8.dihedrals) == 480
    assert zif8.dihedrals == expected_dihedrals
