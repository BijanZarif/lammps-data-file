from lammps_data.crystal import MOF
from lammps_data.bonds import extrapolate_bonds
from lammps_data.angles import get_angles
from lammps_data.dihedrals import get_dihedrals

expected_angles = [(0, 23, 21), (0, 44, 37), (0, 44, 38), (1, 20, 18), (1, 47, 37), (1, 47, 45), (2, 5, 3), (2, 31, 24), (2, 31, 25), (3, 21, 22), (3, 21, 23), (4, 3, 5), (4, 3, 21), (5, 2, 31), (5, 3, 21), (6, 8, 9), (6, 18, 19), (6, 18, 20), (7, 6, 8), (7, 6, 18), (8, 6, 18), (8, 9, 36), (9, 36, 32), (9, 36, 33), (10, 12, 13), (10, 15, 16), (10, 15, 17), (11, 10, 12), (11, 10, 15), (12, 10, 15), (12, 13, 53), (13, 53, 32), (13, 53, 48), (14, 17, 15), (14, 56, 24), (14, 56, 54), (16, 15, 17), (17, 14, 56), (19, 18, 20), (20, 1, 47), (22, 21, 23), (23, 0, 44), (24, 27, 28), (24, 27, 29), (24, 27, 30), (24, 31, 25), (24, 56, 54), (25, 54, 55), (25, 54, 56), (26, 25, 31), (26, 25, 54), (27, 24, 31), (27, 24, 56), (28, 27, 29), (28, 27, 30), (29, 27, 30), (31, 24, 56), (31, 25, 54), (32, 35, 50), (32, 35, 51), (32, 35, 52), (32, 36, 33), (32, 53, 48), (33, 48, 49), (33, 48, 53), (34, 33, 36), (34, 33, 48), (35, 32, 36), (35, 32, 53), (36, 32, 53), (36, 33, 48), (37, 40, 41), (37, 40, 42), (37, 40, 43), (37, 44, 38), (37, 47, 45), (38, 45, 46), (38, 45, 47), (39, 38, 44), (39, 38, 45), (40, 37, 44), (40, 37, 47), (41, 40, 42), (41, 40, 43), (42, 40, 43), (44, 37, 47), (44, 38, 45), (46, 45, 47), (49, 48, 53), (50, 35, 51), (50, 35, 52), (51, 35, 52), (55, 54, 56), (57, 65, 63), (57, 81, 71), (57, 81, 76), (58, 62, 60), (58, 70, 66), (58, 70, 67), (59, 87, 66), (59, 87, 82), (59, 90, 88), (60, 63, 64), (60, 63, 65), (61, 60, 62), (61, 60, 63), (62, 58, 70), (62, 60, 63), (64, 63, 65), (65, 57, 81), (66, 69, 84), (66, 69, 85), (66, 69, 86), (66, 70, 67), (66, 87, 82), (67, 82, 83), (67, 82, 87), (68, 67, 70), (68, 67, 82), (69, 66, 70), (69, 66, 87), (70, 66, 87), (70, 67, 82), (71, 74, 78), (71, 74, 79), (71, 74, 80), (71, 75, 72), (71, 75, 94), (71, 81, 76), (72, 75, 94), (72, 76, 77), (72, 76, 81), (73, 72, 75), (73, 72, 76), (74, 71, 75), (74, 71, 81), (75, 71, 81), (75, 72, 76), (75, 94, 101), (77, 76, 81), (78, 74, 79), (78, 74, 80), (79, 74, 80), (83, 82, 87), (84, 69, 85), (84, 69, 86), (85, 69, 86), (87, 59, 90), (88, 91, 92), (88, 91, 93), (89, 88, 90), (89, 88, 91), (90, 88, 91), (91, 93, 95), (92, 91, 93), (93, 95, 113), (94, 101, 99), (95, 113, 103), (95, 113, 111), (96, 98, 102), (96, 99, 100), (96, 99, 101), (97, 96, 98), (97, 96, 99), (98, 96, 99), (98, 102, 110), (100, 99, 101), (102, 110, 103), (102, 110, 104), (103, 106, 107), (103, 106, 108), (103, 106, 109), (103, 110, 104), (103, 113, 111), (104, 111, 112), (104, 111, 113), (105, 104, 110), (105, 104, 111), (106, 103, 110), (106, 103, 113), (107, 106, 108), (107, 106, 109), (108, 106, 109), (110, 103, 113), (110, 104, 111), (112, 111, 113), (114, 115, 116), (114, 115, 117), (114, 115, 118), (116, 115, 117), (116, 115, 118), (117, 115, 118), (119, 120, 121), (119, 120, 122), (119, 120, 123), (121, 120, 122), (121, 120, 123), (122, 120, 123), (124, 125, 126), (124, 125, 127), (124, 125, 128), (126, 125, 127), (126, 125, 128), (127, 125, 128), (129, 130, 131), (129, 130, 132), (129, 130, 133), (131, 130, 132), (131, 130, 133), (132, 130, 133), (134, 135, 136), (134, 135, 137), (134, 135, 138), (136, 135, 137), (136, 135, 138), (137, 135, 138), (139, 140, 141), (139, 140, 142), (139, 140, 143), (141, 140, 142), (141, 140, 143), (142, 140, 143), (144, 149, 147), (144, 157, 153), (144, 157, 154), (145, 152, 150), (145, 162, 158), (145, 162, 159), (146, 174, 153), (146, 174, 169), (146, 180, 178), (147, 150, 151), (147, 150, 152), (148, 147, 149), (148, 147, 150), (149, 144, 157), (149, 147, 150), (151, 150, 152), (152, 145, 162), (153, 156, 171), (153, 156, 172), (153, 156, 173), (153, 157, 154), (153, 174, 169), (154, 169, 170), (154, 169, 174), (155, 154, 157), (155, 154, 169), (156, 153, 157), (156, 153, 174), (157, 153, 174), (157, 154, 169), (158, 161, 165), (158, 161, 166), (158, 161, 167), (158, 162, 159), (158, 168, 163), (158, 168, 181), (159, 163, 164), (159, 163, 168), (160, 159, 162), (160, 159, 163), (161, 158, 162), (161, 158, 168), (162, 158, 168), (162, 159, 163), (163, 168, 181), (164, 163, 168), (165, 161, 166), (165, 161, 167), (166, 161, 167), (168, 181, 188), (170, 169, 174), (171, 156, 172), (171, 156, 173), (172, 156, 173), (174, 146, 180), (175, 177, 182), (175, 178, 179), (175, 178, 180), (176, 175, 177), (176, 175, 178), (177, 175, 178), (177, 182, 200), (179, 178, 180), (181, 188, 186), (182, 200, 190), (182, 200, 198), (183, 185, 189), (183, 186, 187), (183, 186, 188), (184, 183, 185), (184, 183, 186), (185, 183, 186), (185, 189, 197), (187, 186, 188), (189, 197, 190), (189, 197, 191), (190, 193, 194), (190, 193, 195), (190, 193, 196), (190, 197, 191), (190, 200, 198), (191, 198, 199), (191, 198, 200), (192, 191, 197), (192, 191, 198), (193, 190, 197), (193, 190, 200), (194, 193, 195), (194, 193, 196), (195, 193, 196), (197, 190, 200), (197, 191, 198), (199, 198, 200), (201, 230, 228), (201, 251, 231), (201, 251, 249), (202, 227, 225), (202, 248, 239), (202, 248, 243), (203, 206, 204), (203, 211, 239), (203, 211, 240), (204, 207, 208), (204, 207, 209), (205, 204, 206), (205, 204, 207), (206, 203, 211), (206, 204, 207), (207, 209, 210), (208, 207, 209), (209, 210, 222), (210, 222, 212), (210, 222, 220), (211, 239, 242), (211, 239, 248), (211, 240, 241), (211, 240, 243), (212, 215, 216), (212, 215, 217), (212, 215, 218), (212, 219, 213), (212, 219, 223), (212, 222, 220), (213, 219, 223), (213, 220, 221), (213, 220, 222), (214, 213, 219), (214, 213, 220), (215, 212, 219), (215, 212, 222), (216, 215, 217), (216, 215, 218), (217, 215, 218), (219, 212, 222), (219, 213, 220), (219, 223, 257), (221, 220, 222), (223, 257, 255), (224, 238, 231), (224, 238, 232), (224, 254, 252), (225, 228, 229), (225, 228, 230), (226, 225, 227), (226, 225, 228), (227, 202, 248), (227, 225, 228), (229, 228, 230), (230, 201, 251), (231, 234, 235), (231, 234, 236), (231, 234, 237), (231, 238, 232), (231, 251, 249), (232, 249, 250), (232, 249, 251), (233, 232, 238), (233, 232, 249), (234, 231, 238), (234, 231, 251), (235, 234, 236), (235, 234, 237), (236, 234, 237), (238, 224, 254), (238, 231, 251), (238, 232, 249), (239, 211, 240), (239, 242, 245), (239, 242, 246), (239, 242, 247), (239, 248, 243), (240, 243, 244), (240, 243, 248), (241, 240, 243), (242, 239, 248), (244, 243, 248), (245, 242, 246), (245, 242, 247), (246, 242, 247), (250, 249, 251), (252, 255, 256), (252, 255, 257), (253, 252, 254), (253, 252, 255), (254, 252, 255), (256, 255, 257), (258, 259, 260), (258, 259, 261), (258, 259, 262), (260, 259, 261), (260, 259, 262), (261, 259, 262), (263, 264, 265), (263, 264, 266), (263, 264, 267), (265, 264, 266), (265, 264, 267), (266, 264, 267), (268, 269, 270), (268, 269, 271), (268, 269, 272), (270, 269, 271), (270, 269, 272), (271, 269, 272), (273, 274, 275), (273, 274, 276), (273, 274, 277), (275, 274, 276), (275, 274, 277), (276, 274, 277), (278, 279, 280), (278, 279, 281), (278, 279, 282), (280, 279, 281), (280, 279, 282), (281, 279, 282), (283, 284, 285), (283, 284, 286), (283, 284, 287), (285, 284, 286), (285, 284, 287), (286, 284, 287)]


def test_zif8():
    zif8 = MOF('tests/ZIF-8.xyz')

    zif8.bonds = extrapolate_bonds(zif8.atoms)
    assert len(zif8.bonds) == 288

    zif8.angles = get_angles(zif8.bonds)
    assert len(zif8.angles) == 444
    assert zif8.angles == expected_angles

    zif8.dihedrals = get_dihedrals(zif8.bonds)
